<html lang="en">
<head>
<title>Encrypting a Plaintext - The `GnuPG Made Easy' Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The `GnuPG Made Easy' Reference Manual">
<meta name="generator" content="makeinfo 4.11">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Encrypt.html#Encrypt" title="Encrypt">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Encrypting-a-Plaintext"></a>
Up:&nbsp;<a rel="up" accesskey="u" href="Encrypt.html#Encrypt">Encrypt</a>
<hr>
</div>

<h5 class="subsubsection">7.6.5.1 Encrypting a Plaintext</h5>

<div class="defun">
&mdash; Function: gpgme_error_t <b>gpgme_op_encrypt</b> (<var>gpgme_ctx_t&nbsp;ctx<!-- /@w -->, gpgme_key_t&nbsp;recp[]<!-- /@w -->, gpgme_encrypt_flags_t&nbsp;flags<!-- /@w -->, gpgme_data_t&nbsp;plain<!-- /@w -->, gpgme_data_t&nbsp;cipher<!-- /@w --></var>)<var><a name="index-gpgme_005fop_005fencrypt-308"></a></var><br>
<blockquote><p>The function <code>gpgme_op_encrypt</code> encrypts the plaintext in the data
object <var>plain</var> for the recipients <var>recp</var> and stores the
ciphertext in the data object <var>cipher</var>.  The type of the
ciphertext created is determined by the <acronym>ASCII</acronym> armor and text
mode attributes set for the context <var>ctx</var>.

        <p><var>key</var> must be a <code>NULL</code>-terminated array of keys.  The user
must keep references for all keys during the whole duration of the
call (but see <code>gpgme_op_encrypt_start</code> for the requirements with
the asynchronous variant).

        <p>The value in <var>flags</var> is a bitwise-or combination of one or
multiple of the following bit values:

          <dl>
<dt><code>GPGME_ENCRYPT_ALWAYS_TRUST</code><dd>The <code>GPGME_ENCRYPT_ALWAYS_TRUST</code> symbol specifies that all the
recipients in <var>recp</var> should be trusted, even if the keys do not
have a high enough validity in the keyring.  This flag should be used
with care; in general it is not a good idea to use any untrusted keys. 
</dl>

        <p>If <code>GPG_ERR_UNUSABLE_PUBKEY</code> is returned, some recipients in
<var>recp</var> are invalid, but not all.  In this case the plaintext might
be encrypted for all valid recipients and returned in <var>cipher</var> (if
this happens depends on the crypto engine).  More information about
the invalid recipients is available with
<code>gpgme_op_encrypt_result</code>.

        <p>If <var>recp</var> is <code>NULL</code>, symmetric rather than public key
encryption is performed.  Symmetrically encrypted cipher text can be
deciphered with <code>gpgme_op_decrypt</code>.  Note that in this case the
crypto backend needs to retrieve a passphrase from the user. 
Symmetric encryption is currently only supported for the OpenPGP
crypto backend.

        <p>The function returns the error code <code>GPG_ERR_NO_ERROR</code> if the
ciphertext could be created successfully, <code>GPG_ERR_INV_VALUE</code> if
<var>ctx</var>, <var>recp</var>, <var>plain</var> or <var>cipher</var> is not a valid
pointer, <code>GPG_ERR_UNUSABLE_PUBKEY</code> if <var>recp</var> contains some
invalid recipients, <code>GPG_ERR_BAD_PASSPHRASE</code> if the passphrase
for the symmetric key could not be retrieved, and passes through any
errors that are reported by the crypto engine support routines. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: gpgme_error_t <b>gpgme_op_encrypt_start</b> (<var>gpgme_ctx_t&nbsp;ctx<!-- /@w -->, gpgme_key_t&nbsp;recp[]<!-- /@w -->, gpgme_encrypt_flags_t&nbsp;flags<!-- /@w -->, gpgme_data_t&nbsp;plain<!-- /@w -->, gpgme_data_t&nbsp;cipher<!-- /@w --></var>)<var><a name="index-gpgme_005fop_005fencrypt_005fstart-309"></a></var><br>
<blockquote><p>The function <code>gpgme_op_encrypt_start</code> initiates a
<code>gpgme_op_encrypt</code> operation.  It can be completed by calling
<code>gpgme_wait</code> on the context.  See <a href="Waiting-For-Completion.html#Waiting-For-Completion">Waiting For Completion</a>.

        <p>References to the keys only need to be held for the duration of this
call.  The user can release its references to the keys after this
function returns, even if the operation is not yet finished.

        <p>The function returns the error code <code>GPG_ERR_NO_ERROR</code> if the
operation could be started successfully, <code>GPG_ERR_INV_VALUE</code> if
<var>ctx</var>, <var>rset</var>, <var>plain</var> or <var>cipher</var> is not a valid
pointer, and <code>GPG_ERR_UNUSABLE_PUBKEY</code> if <var>rset</var> does not
contain any valid recipients. 
</p></blockquote></div>

<div class="defun">
&mdash; Data type: <b>gpgme_encrypt_result_t</b><var><a name="index-gpgme_005fencrypt_005fresult_005ft-310"></a></var><br>
<blockquote><p>This is a pointer to a structure used to store the result of a
<code>gpgme_op_encrypt</code> operation.  After successfully encrypting
data, you can retrieve the pointer to the result with
<code>gpgme_op_encrypt_result</code>.  The structure contains the following
members:

          <dl>
<dt><code>gpgme_invalid_key_t invalid_recipients</code><dd>A linked list with information about all invalid keys for which
the data could not be encrypted. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: gpgme_encrypt_result_t <b>gpgme_op_encrypt_result</b> (<var>gpgme_ctx_t&nbsp;ctx<!-- /@w --></var>)<var><a name="index-gpgme_005fop_005fencrypt_005fresult-311"></a></var><br>
<blockquote><p>The function <code>gpgme_op_encrypt_result</code> returns a
<code>gpgme_encrypt_result_t</code> pointer to a structure holding the
result of a <code>gpgme_op_encrypt</code> operation.  The pointer is only
valid if the last operation on the context was a
<code>gpgme_op_encrypt</code>, <code>gpgme_op_encrypt_start</code>,
<code>gpgme_op_sign</code> or <code>gpgme_op_sign_start</code> operation.  If this
operation failed, this might be a <code>NULL</code> pointer.  The returned
pointer is only valid until the next operation is started on the
context. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: gpgme_error_t <b>gpgme_op_encrypt_sign</b> (<var>gpgme_ctx_t&nbsp;ctx<!-- /@w -->, gpgme_key_t&nbsp;recp[]<!-- /@w -->, gpgme_encrypt_flags_t&nbsp;flags<!-- /@w -->, gpgme_data_t&nbsp;plain<!-- /@w -->, gpgme_data_t&nbsp;cipher<!-- /@w --></var>)<var><a name="index-gpgme_005fop_005fencrypt_005fsign-312"></a></var><br>
<blockquote><p>The function <code>gpgme_op_encrypt_sign</code> does a combined encrypt and
sign operation.  It is used like <code>gpgme_op_encrypt</code>, but the
ciphertext also contains signatures for the signers listed in
<var>ctx</var>.

        <p>The combined encrypt and sign operation is currently only available
for the OpenPGP crypto engine. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: gpgme_error_t <b>gpgme_op_encrypt_sign_start</b> (<var>gpgme_ctx_t&nbsp;ctx<!-- /@w -->, gpgme_key_t&nbsp;recp<!-- /@w -->, gpgme_encrypt_flags_t&nbsp;flags<!-- /@w -->, gpgme_data_t&nbsp;plain<!-- /@w -->, gpgme_data_t&nbsp;cipher<!-- /@w --></var>)<var><a name="index-gpgme_005fop_005fencrypt_005fsign_005fstart-313"></a></var><br>
<blockquote><p>The function <code>gpgme_op_encrypt_sign_start</code> initiates a
<code>gpgme_op_encrypt_sign</code> operation.  It can be completed by
calling <code>gpgme_wait</code> on the context.  See <a href="Waiting-For-Completion.html#Waiting-For-Completion">Waiting For Completion</a>.

        <p>The function returns the error code <code>GPG_ERR_NO_ERROR</code> if the
operation could be started successfully, and <code>GPG_ERR_INV_VALUE</code>
if <var>ctx</var>, <var>rset</var>, <var>plain</var> or <var>cipher</var> is not a valid
pointer. 
</p></blockquote></div>

   </body></html>

