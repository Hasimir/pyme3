<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html40/loose.dtd">
<HTML>
<!-- Created on June, 7 2005 by texi2html 1.66 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<HEAD>
<TITLE>The `GnuPG Made Easy' Reference Manual: Passphrase Callback</TITLE>

<META NAME="description" CONTENT="The `GnuPG Made Easy' Reference Manual: Passphrase Callback">
<META NAME="keywords" CONTENT="The `GnuPG Made Easy' Reference Manual: Passphrase Callback">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.66">

</HEAD>

<BODY LANG="en" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC43"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_42.html#SEC42"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_44.html#SEC44"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_34.html#SEC34"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_37.html#SEC37"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_78.html#SEC78"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_81.html#SEC81">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H3> 7.3.6 Passphrase Callback </H3>
<!--docid::SEC43::-->
<P>

<A NAME="IDX73"></A>
</P>
<DL>
<DT><U>Data type:</U> <B>gpgme_error_t (*gpgme_passphrase_cb_t)(void *<VAR>hook</VAR>, const char *<VAR>uid_hint</VAR>, const char *<VAR>passphrase_info</VAR>, int <VAR>prev_was_bad</VAR>, int <VAR>fd</VAR>)</B>
<DD><A NAME="IDX74"></A>
The <CODE>gpgme_passphrase_cb_t</CODE> type is the type of functions usable as
passphrase callback function.
<P>

The argument <VAR>uid_hint</VAR> might contain a string that gives an
indication for which user ID the passphrase is required.  If this is
not available, or not applicable (in the case of symmetric encryption,
for example), <VAR>uid_hint</VAR> will be <CODE>NULL</CODE>.
</P>
<P>

The argument <VAR>passphrase_info</VAR>, if not <CODE>NULL</CODE>, will give
further information about the context in which the passphrase is
required.  This information is engine and operation specific.
</P>
<P>

If this is the repeated attempt to get the passphrase, because
previous attempts failed, then <VAR>prev_was_bad</VAR> is 1, otherwise it
will be 0.
</P>
<P>

The user must write the passphrase, followed by a newline character,
to the file descriptor <VAR>fd</VAR>.  If the user does not return 0
indicating success, the user must at least write a newline character
before returning from the callback.
</P>
<P>

If an error occurs, return the corresponding <CODE>gpgme_error_t</CODE>
value.  You can use the error code <CODE>GPG_ERR_CANCELED</CODE> to abort
the operation.  Otherwise, return <CODE>0</CODE>.
</P>
</DL>
<P>

<A NAME="IDX75"></A>
</P>
<DL>
<DT><U>Function:</U> void <B>gpgme_set_passphrase_cb</B> <I>(gpgme_ctx_t <VAR>ctx</VAR>, gpgme_passphrase_cb_t <VAR>passfunc</VAR>, void *<VAR>hook_value</VAR>)</I>
<DD>The function <CODE>gpgme_set_passphrase_cb</CODE> sets the function that is
used when a passphrase needs to be provided by the user to
<VAR>passfunc</VAR>.  The function <VAR>passfunc</VAR> needs to implemented by
the user, and whenever it is called, it is called with its first
argument being <VAR>hook_value</VAR>.  By default, no passphrase callback
function is set.
<P>

Not all crypto engines require this callback to retrieve the
passphrase.  It is better if the engine retrieves the passphrase from
a trusted agent (a daemon process), rather than having each user to
implement their own passphrase query.  Some engines do not even
support an external passphrase callback at all, in this case the error
code <CODE>GPG_ERR_NOT_SUPPORTED</CODE> is returned.
</P>
<P>

The user can disable the use of a passphrase callback function by
calling <CODE>gpgme_set_passphrase_cb</CODE> with <VAR>passfunc</VAR> being
<CODE>NULL</CODE>.
</P>
</DL>
<P>

<A NAME="IDX76"></A>
</P>
<DL>
<DT><U>Function:</U> void <B>gpgme_get_passphrase_cb</B> <I>(gpgme_ctx_t <VAR>ctx</VAR>, gpgme_passphrase_cb_t *<VAR>passfunc</VAR>, void **<VAR>hook_value</VAR>)</I>
<DD>The function <CODE>gpgme_get_passphrase_cb</CODE> returns the function that
is used when a passphrase needs to be provided by the user in
<VAR>*passfunc</VAR>, and the first argument for this function in
<VAR>*hook_value</VAR>.  If no passphrase callback is set, or <VAR>ctx</VAR> is
not a valid pointer, <CODE>NULL</CODE> is returned in both variables.
<P>

<VAR>passfunc</VAR> or <VAR>hook_value</VAR> can be <CODE>NULL</CODE>.  In this case,
the corresponding value will not be returned.
</P>
</DL>
<P>

<A NAME="Progress Meter Callback"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_42.html#SEC42"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_44.html#SEC44"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_34.html#SEC34"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_37.html#SEC37"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_78.html#SEC78"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_81.html#SEC81">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gpgme_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>
<FONT SIZE="-1">
This document was generated
by <I>Igor Belyi</I> on <I>June, 7 2005</I>
using <A HREF="http://texi2html.cvshome.org"><I>texi2html</I></A>
</FONT>

</BODY>
</HTML>
